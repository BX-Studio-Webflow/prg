const B={1:"Corporate Accounting",2:"Public Accounting",3:"Finance",4:"Commercial Lines Account Manager",5:"Personal Lines Account Manager",6:"Employee Benefits Account Manager",7:"Underwriting",8:"Commercial Casualty Claims",9:"Complex/Specialty Claims",10:"Commercial Property Claims",11:"Personal Lines Claims",12:"Workers' Compensation Claims",13:"Corporate Legal",14:"Technology",15:"Risk Management",16:"Reinsurance",17:"Executive Search",18:"Other"},x="https://prg-one.vercel.app";document.addEventListener("DOMContentLoaded",async()=>{const S=document.querySelector("[dev-target=job-search]"),v=document.querySelectorAll("[dev-target-filters]"),f=document.querySelector("[dev-target=job-item-template]"),h=document.querySelector("[dev-target=job-loader]"),A=document.querySelector("[dev-target=jobs-reset]"),L=document.querySelector("[dev-target=jobs-wrapper]"),y=document.querySelector("[dev-target=job-list]"),M=Object.entries(B).map(([e,t])=>({id:e,name:t}));let b="",m="",g="",u=null;if(!S||!v||!f||!h||!L||!A||!y)return console.error("Missing elements");try{const e=await W();console.log({jobs:e}),u=e,C({jobs:e,jobList:y,jobLoader:h,jobItemTemplate:f,jobsWrapper:L}),F({jobSearchInput:S,jobItemTemplate:f,jobList:y,jobLoader:h,jobsWrapper:L}),J({jobFilterWrappers:v,jobItemTemplate:f,jobList:y,jobLoader:h,jobsWrapper:L}),A.addEventListener("click",()=>{k({jobList:y,jobLoader:h,jobItemTemplate:f,jobsWrapper:L,jobSearchInput:S,jobFilterWrappers:v})}),document.addEventListener("click",t=>{t.target instanceof Element&&!t.target.closest("[dev-target-filters]")&&v.forEach(n=>{const r=n.querySelector("[dev-target=dd-wrapper]");r&&r.setAttribute("dev-hide","true")})})}catch(e){console.error("Something went wrong",e)}function k({jobList:e,jobLoader:t,jobItemTemplate:n,jobsWrapper:r,jobSearchInput:a,jobFilterWrappers:s}){if(b="",m="",g="",a.value="",s.forEach(o=>{const c=o.querySelector("[dev-target=dd-input]");if(!c)return console.error("Missing filter dropdown elements");c.textContent="Select one..."}),u){const o=w({category:m,jobs:u,search:g,state:b});C({jobs:o,jobList:e,jobLoader:t,jobItemTemplate:n,jobsWrapper:r})}}function F({jobSearchInput:e,jobItemTemplate:t,jobList:n,jobLoader:r,jobsWrapper:a}){e.addEventListener("input",s=>{if(g=s.target.value,u){const c=w({category:m,jobs:u,search:g,state:b});C({jobs:c,jobList:n,jobLoader:r,jobItemTemplate:t,jobsWrapper:a})}})}function w({category:e,jobs:t,search:n,state:r}){return{...t,data:t.data.filter(a=>{var l,i,j,p;const s=n===""||a.title.toLowerCase().includes(n.toLowerCase())||((l=a.address.state)==null?void 0:l.toLowerCase().includes(n.toLowerCase()))||((i=a.address.city)==null?void 0:i.toLowerCase().includes(n.toLowerCase()))||((j=a.customText2)==null?void 0:j.toLowerCase().includes(n.toLowerCase())),o=r===""||((p=a.address.state)==null?void 0:p.toLowerCase())===r.toLowerCase(),c=e===""||a.externalCategoryID===parseInt(e);return s&&o&&c})}}function J({jobFilterWrappers:e,jobItemTemplate:t,jobList:n,jobLoader:r,jobsWrapper:a}){e.forEach(async s=>{const o=s.getAttribute("dev-target-filters"),c=s.querySelector("[dev-target=dd-input]"),l=s.querySelector("[dev-target=dd-wrapper]");if(!l||!c)return console.error("Missing filter dropdown elements");if(!o)return console.error("Missing filter type");if(o==="state"){const i=await $();q({filterDropdownInput:c,filterDropdownWrapper:l,filterList:i,filterType:o,jobItemTemplate:t,jobList:n,jobLoader:r,jobsWrapper:a})}else o==="category"&&q({filterDropdownInput:c,filterDropdownWrapper:l,filterList:M,filterType:o,jobItemTemplate:t,jobList:n,jobLoader:r,jobsWrapper:a})})}function q({filterDropdownInput:e,filterDropdownWrapper:t,filterList:n,filterType:r,jobList:a,jobLoader:s,jobItemTemplate:o,jobsWrapper:c}){const l=document.querySelectorAll("[dev-target=dd-wrapper]"),i=t.querySelector("[dev-target=dd-container]"),j=t.querySelector("[dev-target=dd-item-template]");if(!i||!j)return console.error("Missing filter dropdown elements");i.innerHTML="",console.log({filterDropdownInput:e}),e.addEventListener("click",()=>{console.log("click"),l.forEach(d=>{d!==t&&d.setAttribute("dev-hide","true")}),t.getAttribute("dev-hide")==="true"?t.setAttribute("dev-hide","false"):t.setAttribute("dev-hide","true")});const p=j.cloneNode(!0);p.textContent="Select one...",p.addEventListener("click",()=>{if(e.textContent="Select one...",r==="state"?b="":r==="category"&&(m=""),t.setAttribute("dev-hide","true"),u){const d=w({category:m,jobs:u,search:g,state:b});C({jobs:d,jobList:a,jobLoader:s,jobItemTemplate:o,jobsWrapper:c})}}),i.appendChild(p),n.filter(Boolean).forEach(d=>{const I=j.cloneNode(!0),E=typeof d=="string"?d:d.name,P=typeof d=="string"?"":d.id;I.textContent=E,I.addEventListener("click",()=>{if(e.textContent=E,r==="state"?b=E:r==="category"&&(m=P),t.setAttribute("dev-hide","true"),u){const R=w({category:m,jobs:u,search:g,state:b});C({jobs:R,jobList:a,jobLoader:s,jobItemTemplate:o,jobsWrapper:c})}}),i.appendChild(I)})}function C({jobs:e,jobList:t,jobLoader:n,jobItemTemplate:r,jobsWrapper:a}){t.innerHTML="",e.data.forEach(s=>{const o=r.cloneNode(!0),c=o.querySelector("[dev-target=item-link]"),l=o.querySelector("[dev-target=item-title]"),i=o.querySelector("[dev-target=location]");if(!c||!l||!i)return console.error("Missing job item elements");c.href=`/internal-jobs?id=${s.id}`,l.textContent=s.title,i.textContent=`${s.address.city??""}${s.address.city&&s.address.state?" / ":""}${s.address.state??""}`,t.appendChild(o)}),T({element:n,toggle:"hide"}),T({element:a,toggle:"show"})}function T({element:e,toggle:t}){t==="show"?e.setAttribute("dev-hide","false"):e.setAttribute("dev-hide","true")}async function W(){try{const e=await fetch(`${x}/api/jobs`);if(!e.ok)throw new Error("Failed to fetch jobs");return await e.json()}catch(e){throw console.error("Error fetching jobs:",e),e}}async function $(){try{const e=await fetch(`${x}/api/states`);if(!e.ok)throw new Error("Failed to fetch job states");return await e.json()}catch(e){throw console.error("Error fetching job states:",e),e}}});
//# sourceMappingURL=jobs.js.map
